"use strict";!function(e){function t(e,t){var a={tgsb:"pc"};for(var n in t)a[n]=t[n];this.tgsb=a.tgsb,this.city_name="",this.hd_name="",this.init()}var a=this;t.prototype={init:function(){this.city_name=null!=this.getQueryString("city")?this.getQueryString("city"):"all",this.hd_name=this.fieldUrl(),this.renderPage(this.city_name,this.hd_name),this.changeFn()},getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(t);try{return decodeURI(a[2])}catch(e){try{return $URL.decode(a[2])}catch(e){return null}}},fieldUrl:function(){var e=window.location.pathname.split("/");return"hd"==e[1]?"homebuyers":e[1]},back_imgUrl:function(e,t,a,n){$("#banner").attr("src",e["bg_"+n+"_url"]),setTimeout(function(){$("#html").css("opacity","1")},100),$("#loupanList").css("background",e.list_div_bg_color),$("#hd_btn").html(t.submit_btn_title),$("#title").html(t.head_title),$(".explain").css("border","5px solid "+e.style_color),$(".tab_btn").css("background",e.style_color),"pc"==n?($("section dl").css("background",e.list_li_bg_color),$(".juzhong .on").css({background:e.selected_color}),$("section dt").css({background:e.style_color,color:e.item_names_color}),$(".seascape_footer").css("background",e.style_color),$(".juzhong p").css("color",e.categories_color),$(".footer1").css("background",e.style_color),$("#hd_btn").css("background",e.submit_btn_color),$("#hd_btn").css("color",e.style_color)):$(".juzhong .on").css({color:e.selected_color})},liuzi:function(e,t,a,n){$(".wrap").Liuzi({huodongUrl:a.liuzi_api_url,yanBtnColor:"yanzm_btncolor",clue_type_id:a.clue_type_id,tgsb:e,yanzmText:"获取",cityName:t,hd_name:n,layoutType:a.alert_type,hd_alertArr:{succeedStr:a[e+"_succeed_alert"],repeatStr:a[e+"_repeat_alert"]}})},changeFn:function(){var e=this;$(".juzhong").on("click",".tabCity",function(){$(this).addClass("on").siblings().removeClass("on").attr("style",""),e.city_name=$(this).attr("indexId"),e.setCookie("city_name",e.city_name);var t=$(this).attr("data-id"),a=JSON.parse(localStorage.getItem("cunData"));"pc"==e.tgsb?e.succeed_pc_page(a[t],e.zjfromFn(),e.city_name):e.succeed_m_page(a[t],e.zjfromFn(),e.city_name),e.imPage(e.tgsb,e.city_name)})},setCookie:function(e,t,a){var n=new Date;n.setTime(n.getTime()+864e8),document.cookie=e+"="+encodeURI(t)+";expires="+n.toGMTString()+";domain = zeju.com;path=/"},renderPage:function(e,t){var a=this;$.ajax({type:"GET",url:"http://webapi.zeju.com/hd_templates/index",data:{city_name:e,hd_name:t},success:function(n){if("all"==a.city_name&&(a.city_name="bj",e="bj"),"fail"==n.message)a.failData(e,a.tgsb);else if("succeed"==n.message){var c=n.data;localStorage.setItem("cunData",JSON.stringify(c)),a.setCookie("city_name",a.city_name),"pc"==a.tgsb?a.succeed_pc_page(c[0],a.zjfromFn(),a.city_name):a.succeed_m_page(c[0],a.zjfromFn(),a.city_name),$("#explain_info").html(n.data.hd_config.roles),a.back_imgUrl(c.colors,c.hd_config,c.city,a.tgsb),a.liuzi(a.tgsb,a.city_name,c.hd_config,t),a.imPage(a.tgsb,a.city_name),$("#hd_phone").on("keyup",function(){var e=/^1[34578]\d{9}$/;"pc"==a.tgsb?11==$(this).val().length&&e.test($(this).val())?$("#hd_yanzmBtn").addClass("yanzm_btncolor").css({background:c.colors.submit_btn_color,color:c.colors.style_color}).attr("disabled",!1):$("#hd_yanzmBtn").removeClass("yanzm_btncolor").css({background:"#c6c6c6",color:"#333"}).attr("disabled",!0):11==$(this).val().length&&e.test($(this).val())?$("#hd_yanzmBtn").addClass("yanzm_btncolor").css("background","#F63").attr("disabled",!1):$("#hd_yanzmBtn").removeClass("yanzm_btncolor").css("background","#c6c6c6").attr("disabled",!0)})}}})},failData:function(e,t){var a=3;setInterval(function(){var n='<img src="/hd/assets/images/404.png"/><span><b>'+a+"</b>秒后跳转到首页...</span>";$("#body").html(n).addClass("body404"),0==--a&&(window.location.href="pc"==t?"http://"+e+".zeju.com/index":"http://m.zeju.com/"+e),$("#html").css("opacity","1")},1e3)},succeed_pc_page:function(e,t,a){var n="";$.each(e,function(c,s){if(c%4==0&&(n+="<section>"),n+="\t<dl>\n            <dt>"+s.item_name+'</dt>\n            <dd>\n              <a href="http://'+a+".zeju.com/loupan/"+s.item_spell+"/"+s.item_id+'.html"  target="_blank" style="background-image:url(http://imgs.zeju.cn'+s.cover_pic+')">\n              </a>\n              <p class="price">',4==s.price_type?n+="<span>总价 <b>"+s.average_price/1e4+"</b> 万元／套</span>":""!=s.average_price?n+="<span>均价 <b>"+s.average_price+"</b> 元／㎡</span>":n+="<b>暂无价格</b>",void 0!=s.ext_phone&&null!=s.ext_phone?n+='<p class="phone"><b>售楼电话：</b><span>400-656-1188 转 '+s.ext_phone+t+"</span></p>":n+='<p class="phone"><b>售楼电话：</b><span>400-656-1188 转 0</span></p>',n+='<p class="dizhi duo"><b>售楼地址：</b><span>'+s.detail_addres+'</span></p>\n                  <p class="liyou">\n                    <a href="http://'+a+".zeju.com/loupan/"+s.item_spell+"/"+s.item_id+'.html"  target="_blank">\n                      <span>'+s.labels+"</span>\n                    </a>\n                  </p>\n                </dd>\n              </dl>",e.length%4!=0&&c+1==e.length/4*4)for(var i=4*Math.ceil(e.length/4)-(c+1),o=0;o<i;o++)n+='<dl style="background:transparent"><dd></dd></dl>';c%4==3&&(n+="</section>")}),$("#loupan_cont").html(n)},succeed_m_page:function(e,t,a){var n="";$.each(e,function(e,c){n+='<dl class="list">\n          <dt>\n            <a href="http://m.zeju.com/'+a+"/loupan/loupan_detail/"+c.item_id+'" style="background-image:url(http://imgs.zeju.cn'+c.cover_pic+')"></a>',null==c.price_type||0==c.average_price||null==c.average_price?n+='<p class="price"><span>价格 - 暂无</span>':4==c.price_type?n+="<p><span>总价 <b>"+c.average_price/1e4+"</b> 万元／套</span>":n+="<p><span>均价 <b>"+c.average_price+"</b> 元／m²</span>",n+='</p>\n              </dt>\n              <dd class="text">\n                <p class="title">'+c.item_name+'</p>\n                <p class="address">售楼地址：'+c.detail_addres+'</p>\n                <p class="label_title">'+c.labels+"</p>",void 0!=c.ext_phone&&null!=c.ext_phone?n+='<p class="phone"><a href="tel:4006561188,'+(c.ext_phone+t)+'">':n+='<p class="phone"><a href="tel:4006561188,0">',n+='<img src="assets/images/m_rexian.png"></a></p>\n              </dd>\n          </dl>'}),$("#loupanList").html(n)},imPage:function(e,t){"pc"==e?($("#zixun").on("click",function(){var e=$('<iframe class="iframe" id="iframe" src="/hd/im.html?city='+t+'"></iframe>');$("#iframe_box").html(e),$("#iframe_box").show(),$("#guan_iframe").show()}),$("#guan_iframe").on("click",function(){$("#iframe_box").hide(),$("#guan_iframe").hide()})):$("#online").attr("href","http://m.zeju.com/m/index.html?city_name="+t).show()},zjfromFn:function(){var e=this.getQueryString("zjfrom");return null!=e&&""!=e?e<10&&(e="0"+e):e="m"==this.tgsb?"00":"16",e}},$.fn.extend({Public:function(e){return new t(a,e)}})}(window);