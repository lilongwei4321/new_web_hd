"use strict";!function(t,e){function r(t,r,n){var a={nameId:"#hd_name",phoneId:"#hd_phone",yanzmId:"#hd_yanzm",yanzmBtn:"#hd_yanzmBtn",hdBtn:"#hd_btn",nameError:"#name_error",phoneError:"#phone_error",yanError:"#yan_error",publicError:"#user_error",huodongUrl:"",yanBtnColor:"#a6a6a6",tgsb:"pc",layoutType:"0",alertId:"#hd_alert",alertArr:[],cityName:"",hd_name:"",yanzmText:"获取验证码",loupan_id:"",loupan_name:"",huidiao:!1,refcode:""};for(var o in r)a[o]=r[o];this.nameId=e(a.nameId),this.phoneId=e(a.phoneId),this.yanzmId=e(a.yanzmId),this.yanzmBtn=e(a.yanzmBtn),this.hdBtn=e(a.hdBtn),this.nameError=e(a.nameError),this.yanError=e(a.yanError),this.phoneError=e(a.phoneError),this.alertId=e(a.alertId),this.publicError=e(a.publicError),this.yanBtnColor=a.yanBtnColor,this.clue_type_id=a.clue_type_id,this.layoutType=a.layoutType,this.refcode=a.refcode,this.reg=/^1[34578]\d{9}$/,this.huodongUrl=a.huodongUrl,this.asyncBtn=!0,this.yanAsync=!0,this.time=null,this.yanzmText=a.yanzmText,this.tgsb=a.tgsb,this.alertArr=a.hd_alertArr,this.cityName=a.cityName,this.hd_name=a.hd_name,this.loupan_id=a.loupan_id,this.loupan_name=a.loupan_name,this.huidiao=a.huidiao,this.successful=n,this.removeAllSpace=function(t){return t.replace(/\s+/g,"")},this.init()}r.prototype.init=function(){this.cookieFn(),this.nameFn(this.nameId,this.nameError),this.phoneFn(this.phoneId,this.phoneError,this.yanzmBtn),this.yanzmFn(this.yanzmId,this.phoneId,this.yanError,this.phoneError),this.getPasswordFn(this.phoneId,this.phoneError,this.yanzmBtn),this.keyhuiFn(this.hdBtn)},r.prototype.nameFn=function(t,r){var n=this;t.on("keyup",function(t){""!=e(this).val()&&("3"==n.layoutType?n.publicError.html(""):r.slideUp(500))}),t.on("keydown",function(t){if(t||(t=window.event),13==(t.keyCode||t.which))return n.activityFn(),!1;9==(t.keyCode||t.which)&&""==e(this).val()&&("3"==n.layoutType||"4"==n.layoutType?n.publicError.html(n.alertArr.nameErrorText):r.slideDown(500))}),"m"==this.tgsb&&t.on("blur",function(){""!=e(this).val()?"3"==n.layoutType||"4"==n.layoutType?n.publicError.html(""):r.slideUp(500):"3"==n.layoutType||"4"==n.layoutType?n.publicError.html(n.alertArr.nameErrorText):r.slideDown(500)})},r.prototype.phoneFn=function(t,r,n){var a=this;t.on("keyup",function(t){return a.asyncBtn?Number(e(this).val())||""==e(this).val()?("3"==a.layoutType||"4"==a.layoutType||r.slideUp(500),void(11==e(this).val().length&&a.reg.test(e(this).val())?n.css("background",a.yanBtnColor).attr("disabled",!1):n.css("background","#a6a6a6").attr("disabled",!0))):("3"==a.layoutType||"4"==a.layoutType?a.publicError.html(a.alertArr.phoneErrorText):r.slideDown(500),!1):(a.asyncBtn=!0,!1)}),t.on("keydown",function(t){if(t||(t=window.event),13==(t.keyCode||t.which))return a.activityFn(),a.asyncBtn=!1,!1;9==(t.keyCode||t.which)&&(a.reg.test(e(this).val())||("3"==a.layoutType||"4"==a.layoutType?a.publicError.html(a.alertArr.phoneErrorText):r.slideDown(500)))})},r.prototype.yanzmFn=function(t,r,n,a){var o=this;t.on("focus",function(t){o.reg.test(r.val())||("3"==o.layoutType||"4"==o.layoutType?o.publicError.html(o.alertArr.phoneErrorText):a.slideDown(500))}),t.on("keyup",function(t){if(!o.yanAsync)return o.yanAsync=!0,!1;""!=e(this).val()&&("3"==o.layoutType||"4"==o.layoutType?o.publicError.html(""):n.slideUp(500))}),t.on("keydown",function(t){if(t||(t=window.event),13==(t.keyCode||t.which))return o.activityFn(),o.yanAsync=!1,!1;9==(t.keyCode||t.which)&&""==e(this).val()&&("3"==o.layoutType||"4"==o.layoutType?o.publicError.html(o.alertArr.yanErrorText):n.slideDown(500))})},r.prototype.getPasswordFn=function(t,r,n){var a=this;n.on("click",function(){var o=t.val();""!=o&&a.reg.test(o)?(e(this).css("background","#c6c6c6"),r.slideUp(500),t.attr("disabled",!0),a.sendCode(t,n,60),a.yanError.slideUp(500)):r.slideDown(500)})},r.prototype.keyhuiFn=function(t){var e=this;"pc"==this.tgsb&&(document.onkeydown=function(t){if(t||(t=window.event),13==(t.keyCode||t.which))return e.activityFn(),!1}),t.on("click",function(t){return e.activityFn(),!1})},r.prototype.activityFn=function(){var t=this.nameId.val(),r=this.phoneId.val(),n=this.yanzmId.val(),a=this;if(0==a.layoutType||"1"==a.layoutType||5==a.layoutType){if(""==this.removeAllSpace(t)&&this.nameError.slideDown(500),""!=r&&a.reg.test(r)||this.phoneError.slideDown(500),""==a.removeAllSpace(n)&&this.yanError.slideDown(500),""==a.removeAllSpace(t)||""==a.removeAllSpace(n)||!a.reg.test(r))return!1}else if(3==a.layoutType||4==a.layoutType){if(""==this.removeAllSpace(t))return this.publicError.html(a.alertArr.nameErrorText),!1;if(""==r||!a.reg.test(r))return this.publicError.html(a.alertArr.phoneErrorText),!1;if(""==a.removeAllSpace(n))return this.publicError.html(a.alertArr.yanErrorText),!1}e("#select_city").length>0?a.cityName=e("#select_city").find("p").attr("data-id"):null!=getCookie("city_name")&&void 0!=getCookie("city_name")&&(a.cityName=getCookie("city_name")),e.ajax({type:"POST",url:a.huodongUrl,data:{nick_name:t,phone:r,code:n,city_name:a.cityName,hd_name:a.hd_name,zjfrom:a.zjfrom,tgjh:a.tgjh,tgdy:a.tgdy,gjc:a.gjc,gjcppms:a.gjcppms,gjcpm:a.gjcpm,tgcy:a.tgcy,ggsc:a.ggsc,ggw:a.ggw,pd:a.pd,xq:a.xq,xb:a.xb,nld:a.nld,tgsb:a.tgsb,loupan_id:a.loupan_id,loupan_name:a.loupan_name,clue_type_id:a.clue_type_id,refcode:a.refcode,visitor_id:getCookie("niandu_customer_id")},async:!1,success:function(t){"succeed"==t.message?(setCookie("niandu_customer_id",t.data.customer_id),setCookie("niandu_phone",t.data.phone),a.statusSucceed()):"fail"==t.message?a.statusFail():"participated"==t.message?(setCookie("niandu_customer_id",t.data.customer_id),setCookie("niandu_phone",t.data.phone),a.statusRepeat()):"precondition_required"==t.message&&a.expire(t)},error:function(t){console.log(t)}});var o="";6==a.clue_type_id?o="提交领取红包":4==a.clue_type_id&&(o="提交预约专车"),zhuge.track(o,{"所属页面":a.hd_name,"品牌馆/楼盘/活动ID":a.loupan_id,"品牌馆/楼盘/活动名称":a.loupan_name,"留资手机号":r.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2")})},r.prototype.statusRepeat=function(){var t=this;if("pc"==this.tgsb){if("0"==this.layoutType)e("#footer1").fadeIn(),e("#success_cont").html(""+t.alertArr.repeatStr),setTimeout(function(){t.yanError.hide()},3e3);else if("1"==this.layoutType)t.alertId.html(t.alertArr.repeatStr),t.alertId.show(),setTimeout(function(){t.alertId.hide()},3e3);else if("3"==this.layoutType||"4"==this.layoutType)return this.publicError.html(t.alertArr.repeatStr),!1;setTimeout(function(){t.nameId.val(""),t.phoneId.val("").attr("disabled",!1),t.yanzmId.val(""),e("#footer1").fadeOut(),clearInterval(t.time),t.yanzmBtn.val(t.yanzmText).css("background","#a6a6a6")},3e3)}else if("m"==this.tgsb)if("0"==this.layoutType)e("#liuzi").hide(),e("#statusId").show(),e("#success_cont").html(t.alertArr.repeatStr),setTimeout(function(){t.nameId.val(""),t.phoneId.val("").attr("disabled",!1),t.yanzmId.val(""),e("#liuzi").show(),e("#statusId").fadeOut(),clearInterval(t.time),t.yanzmBtn.val(t.yanzmText).css("background","#a6a6a6")},3e3);else if("3"==this.layoutType||"4"==this.layoutType)return this.publicError.html(t.alertArr.repeatStr),!1},r.prototype.statusFail=function(){if("pc"==this.tgsb){if("0"==this.layoutType)this.yanError.slideDown(500);else if("1"==this.layoutType)this.yanError.slideDown(500);else if("3"==this.layoutType||"4"==this.layoutType)return this.publicError.html(this.alertArr.yanErrorText),!1}else if("m"==this.tgsb)if("0"==this.layoutType||5==this.layoutType)this.yanError.slideDown(500);else if("3"==this.layoutType||"4"==this.layoutType)return this.publicError.html(this.alertArr.yanErrorText),!1},r.prototype.statusSucceed=function(){var t=this;"pc"==this.tgsb?("0"==this.layoutType?(e("#footer1").fadeIn(),e("#success_cont").html(t.alertArr.succeedStr)):"1"==this.layoutType?(t.alertId.html(t.alertArr.succeedStr),t.alertId.show(),setTimeout(function(){t.alertId.hide()},3e3)):"3"==this.layoutType?(e("#footer1").find("img").attr("src",t.alertArr.succeedStr),e("#footer").hide(),e("#footer1").show(),setTimeout(function(){e("#footer").show(),e("#footer1").hide(),t.publicError.html("")},3e3)):"4"==this.layoutType&&(t.huidiao?t.successful({async:!0,phone:t.phoneId.val()}):(t.hdBtn.html(t.alertArr.succeedStr),setTimeout(function(){t.hdBtn.html("预约免费专车")},3e3))),setTimeout(function(){t.nameId.val(""),t.phoneId.val("").attr("disabled",!1),t.yanzmId.val(""),e("#footer1").fadeOut(),clearInterval(t.time),t.yanzmBtn.val(t.yanzmText).css("background","#a6a6a6")},3e3)):"m"==this.tgsb&&("0"==this.layoutType?(e("#liuzi").hide(),e("#statusId").show(),e("#success_cont").html(t.alertArr.succeedStr),setTimeout(function(){t.nameId.val(""),t.phoneId.val("").attr("disabled",!1),t.yanzmId.val(""),e("#liuzi").show(),e("#statusId").hide(),clearInterval(t.time),t.yanzmBtn.val(t.yanzmText).css("background","#a6a6a6")},3e3)):"3"==this.layoutType?(e("#footer1").find("img").attr("src",t.alertArr.succeedStr),e("#footer").hide(),e("#footer1").show(),setTimeout(function(){t.nameId.val(""),t.phoneId.val("").attr("disabled",!1),t.yanzmId.val(""),clearInterval(t.time),t.publicError.html(""),t.yanzmBtn.val(t.yanzmText).css("background","#a6a6a6"),e("#footer").show(),e("#footer1").hide()},3e3)):"4"==this.layoutType?(t.hdBtn.html(t.alertArr.succeedStr),setTimeout(function(){t.hdBtn.html("预约免费专车"),t.nameId.val(""),t.phoneId.val("").attr("disabled",!1),t.yanzmId.val(""),clearInterval(t.time),t.publicError.html(""),t.yanzmBtn.val(t.yanzmText).css("background","#a6a6a6"),e("#footer").show(),e("#footer1").hide()},3e3)):"5"==this.layoutType&&(setCookie("zj_tow11_phone",t.phoneId.val()),setTimeout(function(){e("#box_alert").fadeOut(),e("body").off("touchmove")},2e3)))},r.prototype.expire=function(t){var r=this;"pc"==this.tgsb?("0"==this.layoutType&&(e("#footer1").fadeIn(),e("#success_cont").html(r.alertArr.expireStr)),setTimeout(function(){r.nameId.val(""),r.phoneId.val("").attr("disabled",!1),r.yanzmId.val(""),e("#footer1").fadeOut(),clearInterval(r.time),r.yanzmBtn.val(r.yanzmText).css("background","#a6a6a6")},3e3)):"m"==this.tgsb&&"0"==this.layoutType&&(e("#liuzi").hide(),e("#statusId").show(),e("#success_cont").html(r.alertArr.expireStr),setTimeout(function(){r.nameId.val(""),r.phoneId.val("").attr("disabled",!1),r.yanzmId.val(""),e("#liuzi").show(),e("#statusId").hide(),clearInterval(r.time),r.yanzmBtn.val(r.yanzmText).css("background","#a6a6a6")},3e3))},r.prototype.jianceDaima=function(){if("pc"==this.tgsb){!function(){var t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?d3e30511a214ab27c29703983af591cb";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()}else if("m"==this.tgsb){!function(){var t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?03cf2b129bc3e77b681764ab590e4c39";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()}},r.prototype.cookieFn=function(){function t(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),r=window.location.search.substr(1).match(e);try{return decodeURI(r[2])}catch(t){try{return $URL.decode(r[2])}catch(t){return null}}}function e(t,e,r){var n=new Date;n.setTime(n.getTime()+864e8),document.cookie=t+"="+encodeURI(e)+";expires="+n.toGMTString()+";domain = zeju.com;path=/"}function r(t){var e,r=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(r))?decodeURI(e[2]):null}function n(t){return t<10?"0"+t:t}this.zjfrom=null!=t("zjfrom")?t("zjfrom"):r("zjfrom"),this.tgjh=null!=t("tgjh")?t("tgjh"):r("tgjh"),this.tgdy=null!=t("tgdy")?t("tgdy"):r("tgdy"),this.gjc=null!=t("gjc")?t("gjc"):r("gjc"),this.gjcpm=null!=t("gjcpm")?t("gjcpm"):r("gjcpm"),this.gjcppms=null!=t("gjcppms")?t("gjcppms"):r("gjcppms"),this.tgcy=null!=t("tgcy")?t("tgcy"):r("tgcy"),this.ggsc=null!=t("ggsc")?t("ggsc"):r("ggsc"),this.ggw=null!=t("ggw")?t("ggw"):r("ggw"),this.pd=null!=t("pd")?t("pd"):r("pd"),this.xq=null!=t("xq")?t("xq"):r("xq"),this.xb=null!=t("xb")?t("xb"):r("xb"),this.nld=null!=t("nld")?t("nld"):r("nld"),this.tgsb=this.tgsb,this.jianceDaima(),"m"==this.tgsb?null!=this.zjfrom&&""!=this.zjfrom?this.zjfrom=n(this.zjfrom):this.zjfrom="00":null!=this.zjfrom&&""!=this.zjfrom?this.zjfrom=n(this.zjfrom):this.zjfrom="16",null!=t("zjfrom")&&e("zjfrom",t("zjfrom")),null!=t("tgjh")&&e("tgjh",t("tgjh")),null!=t("tgdy")&&e("tgdy",t("tgdy")),null!=t("gjc")&&e("gjc",t("gjc")),null!=t("gjcpm")&&e("gjcpm",t("gjcpm")),null!=t("gjcppms")&&e("gjcppms",t("gjcppms")),null!=t("tgcy")&&e("tgcy",t("tgcy")),null!=t("ggsc")&&e("ggsc",t("ggsc")),null!=t("ggw")&&e("ggw",t("ggw")),null!=t("pd")&&e("pd",t("pd")),null!=t("xq")&&e("xq",t("xq")),null!=t("xb")&&e("xb",t("xb")),null!=t("nld")&&e("nld",t("nld"))},r.prototype.sendCode=function(t,r,n){var a=this;t.Hunxiao(),r.attr("disabled",!0),e.ajax({type:"POST",url:"http://webapi.zeju.com/vcode/send",data:{phone:t.val(),authenticity_token:e("input[name='authenticity_token']").val(),token:sJWT},cache:!1,dataType:"json",success:function(e){0==e.status?a.time=setInterval(function(){59==--n&&r.css("background","#a6a6a6"),a.daojishi(t,r,n,a.time)},1e3):(r.removeAttr("disabled"),t.attr("disabled",!1),r.css("background",a.yanBtnColor))}})},r.prototype.daojishi=function(t,e,r,n){e.val(r+"秒"),r<1&&(e.val(this.yanzmText).attr("disabled",!1),t.attr("disabled",!1),e.css("background",that.yanBtnColor),clearInterval(this.time))},e.fn.extend({Liuzi:function(t,e){return new r(this,t,e)}})}(window,jQuery);