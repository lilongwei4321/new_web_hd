"use strict";var loupan_id="",loupan_name="";!function(t){function a(t,a){var n={tgsb:"pc",imgUrl:"_pc",data:[],alertAsync:!1};for(var e in a)n[e]=a[e];this.tgsb=n.tgsb,this.imgUrl=n.imgUrl,this.city_name="",this.data=n.data,this.alertAsync=n.alertAsync,this.init()}var n=this;a.prototype={init:function(){this.city_name=null!=this.getQueryString("city")?this.getQueryString("city"):"bj",this.hd_name=this.fieldUrl(),this.renderPage(this.city_name,this.hd_name)},getQueryString:function(t){var a=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(a);try{return decodeURI(n[2])}catch(t){try{return $URL.decode(n[2])}catch(t){return null}}},fieldUrl:function(){var t=window.location.pathname.split("/");return"hd"==t[1]?"hjf":t[1]},back_imgUrl:function(t,a){$("#back_top").attr("src",t.colors["bg_"+a+"_url"].bantop),$("#loupan_apply").attr("src",t.colors["bg_"+a+"_url"].bg_img1),$("#loupan_back").attr("src",t.colors["bg_"+a+"_url"].bg_img2),$("#loupan_bottom").attr("src",t.colors["bg_"+a+"_url"].bg_img3),$(".baoming_btn").css("bacckground",t.colors.submit_btn_color),$(".container_title").find("span").css("background",t.colors.item_category_color),$(".kangenduo_btn").css({"border-color":t.colors.more_info_color,color:t.colors.more_info_color}),$("#footer_text").html(t.hd_config.roles),setTimeout(function(){$("#html").css("opacity","1")},200)},renderPage:function(t,a){var n=this;$.ajax({type:"POST",url:"http://webapi.zeju.com/hd_templates/index",data:{city_name:t,hd_name:a},success:function(a){if("fail"==a.message)n.failData(t,n.tgsb);else if("succeed"==a.message){var e=a.data;n.clearHtml(e,n.zjfromFn()),n.quoteAlert(n.tgsb),n.quoteLiuzi(n.tgsb,n.city_name,n.hd_name,e.hd_config),n.hrefPage(t,n.tgsb),n.morePage(t,n.tgsb),n.back_imgUrl(e,n.tgsb)}}})},clearHtml:function(t,a){var n="";$.each(t.loupans,function(t,e){n+='<div class="tuwen">\n                    <h4 class="container_title"><span>'+e.title+'</span> </h4>\n                    <div class="mainBox_contRow"> ',$.each(e.loupan,function(t,e){var o="";o=4!=e.price_type?e.average_price+"元/㎡":e.average_price+"元/套",n+=t%2==0?'<div class="box"><dl class="divWei left">':'<dl class="divWei right">',n+='<dt>\n                    <a href="javascript:;" data-id="'+e.item_id+'" data-name="'+e.item_spell+'" style="background-image:url(http://imgs.zeju.cn'+e.cover_pic+')" class="loupan_xqbtn"></a>\n                  </dt>\n                  <dd>\n                    <h2>'+e.item_name+'</h2>\n                    <p><span class="price">'+o+'</span><span class="phone_btn">',void 0!=e.ext_phone&&null!=e.ext_phone?n+='<a href="tel:4006561188,'+e.ext_phone+a+'"></a>':n+='<a href="tel:4006561188,0"></a>',n+='</span></p>\n                    <div><input class="baoBtn baoming_btn" type="button" value="我要报名" data-id="'+e.item_id+'" data-name="'+e.item_name+'"></div>\n                  </dd></dl>',t%2==1&&(n+="</div>")}),n+='</div>\n                <h4 class="container_genduo">\n                  <a href="javascript:;" >\n                    <span class="kangenduo_btn" data-name="'+e.title_spell+'">查看更多</span>\n                  </a>\n                </h4>\n              </div>'}),$("#mainBox_cont").html(n)},quoteAlert:function(t){"pc"==t&&$("#seascape_wrap").fromAlerts({title:"预约看房",formAsync:!0,btns:["预约免费专车"]}),$(".baoming_btn").on("click",function(){loupan_id=$(this).attr("data-id"),loupan_name=$(this).attr("data-name"),void 0==loupan_id&&(loupan_id=""),void 0==loupan_name&&(loupan_name=""),"pc"==t?$("#box_alert").show():$(document).scrollTop($("#main_box_from")[0].offsetTop-100)})},quoteLiuzi:function(t,a,n,e){$("#seascape_wrap").Liuzi({cityName:a,huodongUrl:e.liuzi_api_url,hd_name:n,yanBtnColor:"yanzm_btncolor",clue_type_id:"4",tgsb:t,yanzmText:"获取验证码",layoutType:4,hd_alertArr:{nameErrorText:"请输入正确称呼！",phoneErrorText:"请输入正确的手机号！",yanErrorText:"请输入正确的验证码！",repeatStr:e[t+"_repeat_alert"],succeedStr:e[t+"_succeed_alert"]}})},morePage:function(t,a){$(".kangenduo_btn").on("click",function(){var n=$(this).attr("data-name");"pc"==a?window.open("http://"+t+".zeju.com/loupan/"+n.split(",")[0]+"/"):location.href="http://m.zeju.com/"+t+"/loupan/list/index?quyu="+n.split(",")[1]+"/"})},hrefPage:function(t,a){$(".loupan_xqbtn").on("click",function(){var n=$(this).attr("data-id"),e=$(this).attr("data-name");"pc"==a?window.open("http://"+t+".zeju.com/loupan/"+e+"/"+n+".html"):location.href="http://m.zeju.com/"+t+"/loupan/loupan_detail/"+n})},failData:function(t,a){var n=3;setInterval(function(){var e='<img src="/hd/assets/images/404.png"/><span><b>'+n+"</b>秒后跳转到首页...</span>";$("#body").html(e).addClass("body404"),$("#html").css("background","#fff"),0==--n&&(window.location.href="pc"==a?"http://"+t+".zeju.com/index":"http://m.zeju.com/"+t),$("#html").css("opacity","1")},1e3)},zjfromFn:function(){var t=this.getQueryString("zjfrom");return null!=t&&""!=t?t<10&&(t="0"+t):t="m"==this.tgsb?"00":"16",t}},$.fn.extend({Public:function(t){return new a(n,t)}})}(window);