"use strict";!function(t){function e(t,e){var n={tgsb:"pc",imgUrl:""};for(var a in e)n[a]=e[a];this.tgsb=n.tgsb,this.imgUrl=n.imgUrl,this.city_name="",this.hd_name="",this.init()}var n=this;e.prototype={init:function(){$("#geshu_title").hide(),this.city_name=null!=this.getQueryString("city")?this.getQueryString("city"):"tj",this.hd_name=this.fieldUrl(),"lqhb128802"==this.hd_name&&"m"==this.tgsb&&(this.exchangeFN(),this.clickNameFN()),this.renderPage(this.city_name,this.hd_name)},getQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(e);try{return decodeURI(n[2])}catch(t){try{return $URL.decode(n[2])}catch(t){return null}}},fieldUrl:function(){var t=window.location.pathname.split("/");return"hd"==t[1]?"lqhb128802":t[1]},back_imgUrl:function(t,e){$("#back").attr("src",t.colors["bg_"+e+"_url"]),$("#html").css({background:t.colors.bg_color,opacity:"1"}),$("#cont_btn").html(t.hd_config.submit_btn_title).css({background:t.colors.submit_btn_color,cursor:"pointer"}),$(".cont_title").css("color",t.colors.roles_color),$("#cont_box_roles").html(t.hd_config.roles),$("#header_title").html(t.hd_config.head_title)},qiang_hongbao:function(t,e,n,a){if(!e)return $("#html").css("background","#6A7CEC"),$(".main").css({height:"60%",bottom:"4%"}),$(".cont").find("div").addClass("flex1"),!1;$.ajax({type:"GET",url:"http://webapi.zeju.com/liuzi/hd_count",data:{hd_name:n,city_name:t},success:function(t){if("succeed"==t.message){var e=Number(t.data.count)+148;if(Number(e)>=800){Number(e);var n='<span>还剩<b id="qing_name">'+name+"</b>份</span>\n                        <span>限额送<b>1000</b>份</span>"}else n='<span>已抢<b id="qing_name">'+e+"</b>份</span>\n                        <span>限额送<b>1000</b>份</span>";$("#geshu_title").html(n).show(),$("#geshu_title b").css("color",a.bg_color),$("#user_error").css("color",a.bg_color)}}})},liuzi:function(t,e,n,a,i){$(".wrap").Liuzi({nameId:"#user_name",phoneId:"#user_phone",yanzmId:"#user_yanzm",yanzmBtn:"#user_yanzmBtn",hdBtn:"#cont_btn",cityName:e,hd_name:n,huodongUrl:a.liuzi_api_url,yanBtnColor:i.bg_color,clue_type_id:"6",tgsb:t,yanzmText:"获取验证码",layoutType:3,hd_alertArr:{nameErrorText:"请输入正确称呼！",phoneErrorText:"请输入正确的手机号！",yanErrorText:"请输入正确的验证码！",succeedStr:a[t+"_succeed_alert"],repeatStr:a[t+"_repeat_alert"]}})},renderPage:function(t,e){var n=this;$.ajax({type:"POST",url:"http://webapi.zeju.com/hd_templates/index",data:{city_name:t,hd_name:e},success:function(a){if("fail"==a.message)n.failData(t,n.tgsb);else if("succeed"==a.message){var i=a.data;n.liuzi(n.tgsb,n.city_name,e,i.hd_config,i.colors),n.qiang_hongbao(n.city_name,i.hd_config.red_packet_status,e,i.colors),n.back_imgUrl(i,n.tgsb)}}})},failData:function(t,e){var n=3;setInterval(function(){var a='<img src="/hd/assets/images/404.png"/><span><b>'+n+"</b>秒后跳转到首页...</span>";$("#body").html(a).addClass("body404"),$("#html").css("background","#fff"),0==--n&&(window.location.href="pc"==e?"http://"+t+".zeju.com/index":"http://m.zeju.com/"+t),$("#html").css("opacity","1")},1e3)},exchangeFN:function(){var t=document.getElementById("name_box"),e=document.getElementById("user_name"),n=document.getElementById("huan_box");t.style.height="0px",t.style.overflow="hidden",e.value="lqhb128802",n.className=""},clickNameFN:function(){$("#cont_btn").on("click",function(){$("#huan_text").val(""),setTimeout(function(){$("#user_name").val("lqhb128802")},5e3)})}},$.fn.extend({Public:function(t){return new e(n,t)}})}(window);